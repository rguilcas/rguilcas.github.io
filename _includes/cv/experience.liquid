{% comment %}
  Unified work/experience entry renderer for both RenderCV and JSONResume formats
{% endcomment %}

<ul class="cv-list">
  {% for entry in entries %}
    <li class="cv-item {% if entry.logo %}cv-item-with-logo{% endif %}">
      {% if entry.logo %}
        <div class="cv-item-logo">
          <img src="{{ base_path }}/images/{{ entry.logo }}" alt="{{ entry.company }} logo">
        </div>
      {% endif %}
      <div class="cv-item-content">
      <div class="cv-item-header">
        <div class="cv-item-title-group">
          {% capture position_title %}
            {% if entry.position %}{{ entry.position }}{% endif %}
          {% endcapture %}

          {% if entry.url %}
            <div class="cv-item-title"><a href="{{ entry.url }}">{{ position_title }}</a></div>
          {% elsif position_title != '' %}
            <div class="cv-item-title">{{ position_title }}</div>
          {% endif %}

          {% capture company_name %}
            {% if entry.name %}{{ entry.name }}{% elsif entry.company %}{{ entry.company }}{% elsif entry.organization %}{{ entry.organization }}{% endif %}
          {% endcapture %}
          {% if company_name != '' %}
            <div class="cv-item-subtitle">{{ company_name }}</div>
          {% endif %}
        </div>

        {% capture start_date %}
          {% if entry.start_date %}{{ entry.start_date }}{% elsif entry.startDate %}{{ entry.startDate }}{% endif %}
        {% endcapture %}
        {% capture end_date %}
          {% if entry.end_date %}{{ entry.end_date }}{% elsif entry.endDate %}{{ entry.endDate }}{% endif %}
        {% endcapture %}

        {% if start_date != '' %}
          {% assign startDate = start_date | split: '-' | first %}
          {% assign endDateRaw = end_date | split: '-' | first | default: 'Present' %}
          {% if startDate == endDateRaw %}
            <div class="cv-item-date">{{ startDate }}</div>
          {% else %}
            <div class="cv-item-date">{{ startDate }} â€” {{ endDateRaw }}</div>
          {% endif %}
        {% endif %}
      </div>

      {% capture location %}
        {% if entry.location %}{{ entry.location }}{% endif %}
      {% endcapture %}
      {% if location != '' %}
        <div class="cv-item-location">
          <i class="fa-solid fa-location-dot"></i>
          {{ location }}
        </div>
      {% endif %}

      {% if entry.summary %}
        <div class="cv-item-detail">
          {{ entry.summary | markdownify }}
        </div>
      {% endif %}

      {% if entry.highlights %}
        <div class="cv-item-detail">
          <ul>
            {% for item in entry.highlights %}
              <li>{{ item | markdownify | remove: '<p>' | remove: '</p>' }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
      </div>
    </li>
  {% endfor %}
</ul>

